# 网络相关

## 防火墙

参考：https://blog.csdn.net/qq_38265137/article/details/88548511

防火墙的本质是查配路由表，主要做用只是用来防病毒或防黑客。

防火墙有“状态检测”功能，可以开启或关闭。

报文到达防火墙，先查看是否会有会话表匹配（开启了“状态检测”，）
1. 如果有会话表匹配，则匹配会话表转发。
2. 如果没有匹配会话表，看是否能够创建会话表。只有首包才能创建会话表。

tcp 的 SYN 报文(首包)可以创建会话表。防火墙可以设置对 tcp 协议的会话超时时间。

UDP 没有首包概念，每个报文都可以创建会话表。


## 路由器

Internet网络的主要节点设备是路由器，路由器通过路由表来转发接收到的数据。

路由器的主要工作就是为经过路由器的每个数据包寻找一条最佳的传输路径，并将该数据有效地传送到目的站点。

路由表中的表项内容包括：

- destination：目的地址，用来标识IP包的目的地址或者目的网络。
- mask：网络掩码，与目的地址一起标识目的主机或者路由器所在的网段的地址。
- nexthop：下一跳IP地址，说明IP包所经过的下一个路由器。

## NAT 表

网络地址转换（英语：Network Address Translation，缩写：NAT）

路由器上会维护 NAT 表。当信息由本地网络向因特网传递时，源地址从专有地址转换为公用地址。由路由器跟踪每个连接上的基本数据，主要是目的地址和端口。当有回复返回路由器时，它通过输出阶段记录的连接跟踪数据来决定该转发给内部网的哪个主机。

Basic NAT要维护一个无端口号NAT表，结构如下。

``` shell
内网IP	外网IP
192.168.1.55:5566	219.152.168.222:9200
192.168.1.59:80	219.152.168.222:9201
192.168.1.59:4465	219.152.168.222:9202
```




参考：

- https://github.com/halfrost/Halfrost-Field#-protocol