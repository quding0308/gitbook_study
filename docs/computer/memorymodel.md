# C 语言内存模型

![img](/asserts/img/cmemory.png)


text段: 用于存放程序代码的区域(存放处理器的机器指令)，编译时确定，只读。

data段: 用于存放在编译阶段(而非运行时)就能确定的数据，可读可写。

bss段（Block Started by Symbol segment）通常是指用来存放程序中未初始化的全局变量的一块内存区域。
bss段在程序加载运行时分配内存大小和初始化。

text段会占用可执行文件的空间，bss段不会占用可执行文件的空间。

### 从权限的角度

- 只读、可执行：TEXT
- 只读：全局常量
- 可读写：全局变量和 static 变量

### 从静态、动态分配的角度

TEXT、DATA、BSS 属于静态分配区域，程序初始化时，内存已分配好。

堆和栈属于动态区域，程序运行阶段动态分配内存

### 局部变量和全局变量
#### 局部变量
- 局部未初始化静态变量，存储在BSS段
- 局部静态初始化变量，存储在DATA段中
- 局部非静态变量存储在栈中

#### 全局变量

- 静态未初始化全局变量，虽然系统会默认初始化为0，但仍然存放在BSS区
- 静态初始化全局变量，存放 DATA 段
- 未初始化全局数据存储在BSS数据区
- 初始化全局数据存储在RW DATA数据区
- 未初始化全局常量， 自动初始化为0， 但仍然存放在BSS区
- 初始化全局常量，存储在常量区(常量区存储在 TEXT 段中)
- 


线程栈在linux下默认是8M大小,通过 mmap 开辟线程栈,线程栈的起始地址跟大小保存在 pthread_attr_t 中
typedef struct __pthread_attr_s
{
    void *__stackaddr;//起始地址
    size_t __stacksize;//表示堆栈的大小。
}pthread_attr_t;
线程栈在所进程的堆区
CPU 和 GPU 的原理 在渲染阶段分别做的事，针对此 后续能做的优化点。


